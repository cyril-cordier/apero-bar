(this["webpackJsonpapero-bar"]=this["webpackJsonpapero-bar"]||[]).push([[0],{43:function(e,t,c){},44:function(e,t,c){},69:function(e,t,c){"use strict";c.r(t);var n=c(0),s=c(1),a=c.n(s),r=c(34),o=c.n(r),l=(c(43),c(44),c(13)),i=c(2),j=Object(s.createContext)(),b=function(e){var t=Object(s.useState)([]),c=Object(i.a)(t,2),a=c[0],r=c[1],o=Object(s.useState)(""),b=Object(i.a)(o,2),u=b[0],d=b[1],O=Object(s.useState)(""),m=Object(i.a)(O,2),h=m[0],f=m[1],p=Object(s.useState)(null),x=Object(i.a)(p,2),g=x[0],v=x[1],N=Object(s.useState)([]),S=Object(i.a)(N,2),k=S[0],w=S[1],C=Object(s.useState)(null),y=Object(i.a)(C,2),B=y[0],I=y[1],L=Object(s.useState)(null),P=Object(i.a)(L,2),M=P[0],_=P[1];return Object(n.jsx)(j.Provider,{value:{bottles:a,setBottles:r,addBottles:function(e){r([].concat(Object(l.a)(a),[e]))},search:u,setSearch:d,selectedBottle:B,setSelectedBottle:I,message:M,setMessage:_,token:h,setToken:f,user:g,setUser:v,ingredients:k,setIngredients:w,addIngredients:function(e){w([].concat(Object(l.a)(k),[e]))}},children:e.children})},u=c(7),d=c(5),O=c(3),m=c.n(O),h=c(6),f=c(35),p=c.n(f).a.create({baseURL:"https://api-apero-bar.herokuapp.com/api"}),x=function(e){var t=e.headers,c=e.onSorting,a=Object(s.useState)(""),r=Object(i.a)(a,2),o=r[0],l=r[1],j=Object(s.useState)("asc"),b=Object(i.a)(j,2),u=b[0],d=b[1];return Object(n.jsx)("thead",{className:"bg-primary text-white",children:Object(n.jsx)("tr",{children:t.map((function(e){var t=e.name,s=e.field,a=e.sortable;return Object(n.jsxs)("th",{onClick:function(){return a?function(e){var t=e===o&&"asc"===u?"desc":"asc";l(e),d(t),c(e,t)}(s):null},children:[t,o&&o===s&&("asc"===u?Object(n.jsx)("i",{className:"fas fa-arrow-down"}):Object(n.jsx)("i",{class:"fas fa-arrow-up"}))]},t)}))})})},g=function(e){var t=e.onSearch,c=Object(s.useState)(""),a=Object(i.a)(c,2),r=a[0],o=a[1];return Object(n.jsx)("input",{type:"text",className:"form-control",style:{width:"240px"},placeholder:"Recherche",value:r,onChange:function(e){var c;c=e.target.value,o(c),t(c)}})},v=c(17),N=function(e){var t=e.total,c=void 0===t?0:t,a=e.itemsPerPage,r=void 0===a?3:a,o=e.currentPage,l=void 0===o?1:o,j=e.onPageChange,b=Object(s.useState)(0),u=Object(i.a)(b,2),d=u[0],O=u[1];Object(s.useEffect)((function(){c>0&&r>0&&O(Math.ceil(c/r))}),[c,r]);var m=Object(s.useMemo)((function(){for(var e=[],t=function(t){e.push(Object(n.jsx)(v.a.Item,{active:t===l,onClick:function(){return j(t)},children:t},t))},c=1;c<=d;c++)t(c);return e}),[d,l,j]);return 0===d?null:Object(n.jsxs)(v.a,{children:[Object(n.jsx)(v.a.Prev,{onClick:function(){return j(l-1)},disabled:1===l}),m,Object(n.jsx)(v.a.Next,{onClick:function(){return j(l+1)},disabled:l===d})]})},S=c.p+"static/media/loading.2187296e.gif",k=function(){return Object(n.jsx)("div",{className:"fp-container",children:Object(n.jsx)("img",{src:S,alt:"chargement",className:"fp-loader"})})},w=function(){var e=Object(s.useState)(!1),t=Object(i.a)(e,2),c=t[0],a=t[1];return[c?Object(n.jsx)(k,{}):null,function(){return a(!0)},function(){return a(!1)}]};function C(e){var t=Object(s.useContext)(j),c=t.user,a=t.bottles,r=t.setBottles,o=t.token,b=(t.setIngredients,w()),u=Object(i.a)(b,3),O=u[0],f=u[1],v=u[2],S=Object(s.useState)(0),k=Object(i.a)(S,2),C=k[0],y=k[1],B=Object(s.useState)(1),I=Object(i.a)(B,2),L=I[0],P=I[1],M=Object(s.useState)(""),_=Object(i.a)(M,2),U=_[0],F=_[1],E=Object(s.useState)({field:"",order:""}),A=Object(i.a)(E,2),D=A[0],T=A[1],J=Object(s.useState)([{name:"Nom",field:"name",sortable:!0},{name:"Type",field:"type",sortable:!0},{name:"Pays/R\xe9gion",field:"country",sortable:!0},{name:"Mill\xe9sime",field:"vintage",sortable:!0}]),R=Object(i.a)(J,2),z=R[0],V=R[1],G=Object(d.g)();Object(s.useEffect)((function(){c&&!0===c.is_admin&&V([].concat(Object(l.a)(z),[{name:"actions",field:"actions"}]))}),[c]),Object(s.useEffect)((function(){(function(){var e=Object(h.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(),e.prev=1,e.next=4,p.get("/bouteilles",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("bottletoken"),"}")}});case 4:t=e.sent,console.log("\ud83d\ude80 ~ file: BottlesList.js ~ line 42 ~ fetchData ~ fetchBottle",t),r(t.data),v(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}})()()}),[r]);var H=function(){var e=Object(h.a)(m.a.mark((function e(t,c){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(c),t.stopPropagation(),e.prev=2,e.next=5,p.delete("/bouteilles/".concat(c),{headers:{Authorization:"Bearer ".concat(o)}});case 5:n=e.sent,r(a.filter((function(e){return e.id!==c}))),console.log(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,c){return e.apply(this,arguments)}}(),q=Object(s.useMemo)((function(){var e=a;if(U&&(e=e.filter((function(e){return e.name.toLowerCase().includes(U.toLowerCase())||e.category.toLowerCase().includes(U.toLowerCase())||e.type.toLowerCase().includes(U.toLowerCase())||e.country.toLowerCase().includes(U.toLowerCase())}))),y(e.length),D.field){var t="asc"===D.order?1:-1;e=e.sort((function(e,c){return t*e[D.field].localeCompare(c[D.field])}))}return e.slice(50*(L-1),50*(L-1)+50)}),[a,L,U,D]);return Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"row w-100",children:Object(n.jsx)("div",{className:"col mb-3 col-12 text-center",children:Object(n.jsxs)("div",{className:"row",children:[Object(n.jsx)("div",{className:"col-md-6",children:Object(n.jsx)(N,{total:C,itemsPerPage:50,currentPage:L,onPageChange:function(e){return P(e)}})}),Object(n.jsx)("div",{className:"col-md-6 d-flex flex-row-reverse",children:Object(n.jsx)(g,{onSearch:function(e){F(e),P(1)}})})]})})}),Object(n.jsxs)("table",{className:"table table-hover",children:[Object(n.jsx)(x,{headers:z,onSorting:function(e,t){return T({field:e,order:t})}}),Object(n.jsx)("tbody",{children:q&&q.map((function(e){return Object(n.jsxs)("tr",{onClick:function(){return t=e._id,void G.push("/bottles/".concat(t));var t},children:[Object(n.jsx)("td",{children:e.name}),Object(n.jsx)("td",{children:e.type}),Object(n.jsx)("td",{children:e.country}),Object(n.jsx)("td",{children:e.vintage}),c&&c.is_admin?Object(n.jsxs)("td",{className:"row",children:[Object(n.jsx)("button",{className:"btn btn-warning",onClick:function(t){return function(e,t){e.stopPropagation(),G.push("/bottles/".concat(t,"/update"))}(t,e._id)},children:"M\xe0j"}),Object(n.jsx)("button",{className:"btn btn-danger",onClick:function(t){return H(t,e._id)},children:"Sup"})]}):null]},e.id)}))})]}),O]})}function y(){var e=Object(s.useContext)(j),t=e.message;e.user;return Object(n.jsxs)("div",{children:[t?Object(n.jsx)("div",{className:"alert alert-success",children:t}):null,Object(n.jsx)("h1",{children:"Ap\xe9ro-Bar de Cyril"}),Object(n.jsx)(C,{})]})}var B=c(14),I=function(){var e=Object(d.g)(),t=Object(s.useContext)(j),c=t.message,a=t.setMessage,r=t.setToken,o=t.setUser,l=Object(s.useState)(""),b=Object(i.a)(l,2),O=b[0],f=b[1],x=Object(s.useState)(""),g=Object(i.a)(x,2),v=g[0],N=g[1],S=Object(s.useState)(""),k=Object(i.a)(S,2),w=(k[0],k[1]),C=Object(s.useState)(""),y=Object(i.a)(C,2),I=y[0],L=y[1],P=function(){var t=Object(h.a)(m.a.mark((function t(c){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c.preventDefault(),t.prev=1,t.next=4,p.post("/auth",{username:O,password:v});case 4:n=t.sent,w(""),L(""),console.log(n),n.data.access_token&&(localStorage.setItem("bottletoken",n.data.access_token),r(n.data.access_token),o(Object(B.a)(n.data.access_token)),a("Vous \xeates connect\xe9"),e.push("/")),t.next=17;break;case 11:t.prev=11,t.t0=t.catch(1),console.log(JSON.stringify(t.t0.message.substr(-3))),L(t.t0.message.substr(-3)),console.log("code",I),console.log(t.t0);case 17:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}();return Object(n.jsxs)("div",{children:[Object(n.jsx)("h1",{children:"Login"}),c?Object(n.jsx)("div",{className:"alert alert-success",children:c}):null,Object(n.jsxs)("form",{className:"mb-2",action:"submit",children:[Object(n.jsxs)("div",{className:"form-row",children:[Object(n.jsxs)("div",{className:"form-group col-8",children:[Object(n.jsx)("label",{htmlFor:"username",children:"Username"}),Object(n.jsx)("input",{value:O,onChange:function(e){return f(e.target.value)},id:"username",placeholder:"Username",type:"text",className:"form-control"})]}),Object(n.jsxs)("div",{className:"form-group col-8",children:[Object(n.jsx)("label",{htmlFor:"password",children:"Mot de passe"}),Object(n.jsx)("input",{value:v,onChange:function(e){return N(e.target.value)},id:"password",placeholder:"Mot de passe",type:"password",className:"form-control"})]})]}),Object(n.jsx)("button",{type:"submit",onClick:P,className:"btn btn-primary",children:"Submit"})]}),Object(n.jsx)(u.b,{to:"/register",children:Object(n.jsx)("button",{className:"btn btn-primary",children:"Go to Register"})}),Object(n.jsx)(u.b,{to:"/",children:Object(n.jsx)("button",{className:"btn btn-primary",children:"Home"})})]})},L=function(){var e=Object(d.g)(),t=Object(s.useState)(""),c=Object(i.a)(t,2),a=c[0],r=c[1],o=Object(s.useState)(""),l=Object(i.a)(o,2),b=l[0],O=l[1],f=Object(s.useState)(""),x=Object(i.a)(f,2),g=x[0],v=x[1],N=Object(s.useState)(""),S=Object(i.a)(N,2),k=S[0],w=S[1],C=Object(s.useState)(""),y=Object(i.a)(C,2),B=y[0],I=y[1],L=Object(s.useContext)(j).setMessage,P=function(){var t=Object(h.a)(m.a.mark((function t(c){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c.preventDefault(),t.prev=1,t.next=4,p.post("/users/register",{username:a,password:b});case 4:n=t.sent,v(""),I(""),L("Votre compte a bien \xe9t\xe9 cr\xe9\xe9. Vous pouvez vous connecter."),e.push("/login"),console.log(JSON.stringify(n)),t.next=18;break;case 12:t.prev=12,t.t0=t.catch(1),console.log(JSON.stringify(t.t0.message.substr(-3))),I(t.t0.message.substr(-3)),console.log("code",B),t.t0?v("Erreur d'identifiants ou de mot de passe"):v("");case 18:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}();return Object(s.useEffect)((function(){w("500"===B?"L'identifiant n'est pas un username":""),w("409"===B?"L'adresse username existe d\xe9j\xe0":"")}),[B]),Object(n.jsxs)("div",{children:[Object(n.jsx)("h1",{children:"Register"}),Object(n.jsxs)("div",{className:"mb-2",children:[Object(n.jsxs)("div",{className:"form-row",children:[Object(n.jsxs)("div",{className:"form-group col-8",children:[Object(n.jsx)("label",{htmlFor:"username",children:"Username"}),Object(n.jsx)("input",{value:a,onChange:function(e){return r(e.target.value)},id:"username",placeholder:"Username",type:"text",className:"form-control"})]}),Object(n.jsxs)("div",{className:"form-group col-8",children:[Object(n.jsx)("label",{htmlFor:"password",children:"Mot de passe"}),Object(n.jsx)("input",{value:b,onChange:function(e){return O(e.target.value)},id:"password",placeholder:"Mot de passe",type:"password",className:"form-control"})]})]}),k?Object(n.jsx)("p",{className:"alert alert-danger",children:k}):"",g?Object(n.jsx)("p",{className:"alert alert-danger",children:g}):"",Object(n.jsx)("button",{type:"submit",onClick:P,className:"btn btn-primary",children:"Submit"})]}),Object(n.jsx)(u.b,{to:"/login",children:Object(n.jsx)("button",{className:"btn btn-primary",children:"Go to Login"})})]})};function P(){var e=Object(s.useContext)(j),t=e.addBottles,c=e.token,a=e.ingredients,r=Object(s.useState)(""),o=Object(i.a)(r,2),b=o[0],u=o[1],O=Object(s.useState)([]),f=Object(i.a)(O,2),x=f[0],g=f[1],v=Object(s.useState)(""),N=Object(i.a)(v,2),S=N[0],k=N[1],w=Object(s.useState)("Sauce tomate"),C=Object(i.a)(w,2),y=C[0],B=C[1],I=Object(s.useState)(!1),L=Object(i.a)(I,2),P=L[0],M=L[1],_=Object(s.useState)("disponible"),U=Object(i.a)(_,2),F=U[0],E=U[1],A=Object(d.g)(),D=function(){var e=Object(h.a)(m.a.mark((function e(n){var s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,p.post("/bottles",{name:b,ingredients:x[0]?x[0].substr(0,1).toUpperCase()+x.join(", ").substr(1):"",price:S,special:P,base:y,status:F},{headers:{Authorization:"Bearer ".concat(c)}});case 4:s=e.sent,t(s.data.createdBottle),A.push("/"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("h1",{className:"text-center",children:"Add Bottle"}),Object(n.jsx)("p",{className:"text-center",children:"secret page"})]}),Object(n.jsxs)("form",{className:"mb-4",action:"",children:[Object(n.jsxs)("div",{className:"row form-row",children:[Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("input",{type:"text",value:b,onChange:function(e){return u(e.target.value)},className:"form-control",placeholder:"Nom"})}),Object(n.jsx)("div",{className:"col",children:Object(n.jsx)("input",{type:"text",value:S,onChange:function(e){return k(e.target.value)},className:"form-control",placeholder:"Prix"})})]}),Object(n.jsxs)("div",{className:"row form-row",children:[Object(n.jsx)("div",{className:"col",children:Object(n.jsxs)("select",{className:" form-control",value:y,onChange:function(e){return B(e.target.value)},children:[Object(n.jsx)("option",{children:"Sauce tomate"}),Object(n.jsx)("option",{children:"Cr\xe8me fra\xeeche"})]})}),Object(n.jsx)("div",{className:"col",children:Object(n.jsxs)("select",{className:" form-control",value:P,onChange:function(e){return M(e.target.value)},children:[Object(n.jsx)("option",{value:"false",children:"Ordinaire"}),Object(n.jsx)("option",{value:"true",children:"Sp\xe9ciale"})]})})]}),Object(n.jsx)("div",{className:"row form-row",children:Object(n.jsx)("div",{className:"col",children:Object(n.jsxs)("select",{className:" form-control",value:F,onChange:function(e){return E(e.target.value)},children:[Object(n.jsx)("option",{value:"true",children:"Disponible"}),Object(n.jsx)("option",{value:"false",children:"Non disponible"})]})})}),Object(n.jsx)("div",{className:"row from-row",children:Object(n.jsxs)("div",{className:"col",children:[Object(n.jsx)("p",{className:"mt-3",children:"Ingr\xe9dients :"}),Object(n.jsxs)("p",{children:[x[0]?x[0].substr(0,1).toUpperCase()+x.join(", ").substr(1):""," "]})]})}),Object(n.jsx)("div",{className:"form-group"}),a?a.map((function(e){return Object(n.jsxs)("div",{className:"form-check form-check-inline",children:[Object(n.jsx)("input",{className:"form-check-input",type:"checkbox",id:e._id,value:e.name,onClick:function(e){return function(e){var t=x.includes(e);g(t?x.filter((function(t){return t!==e})):[].concat(Object(l.a)(x),[e]))}(e.target.value)}}),Object(n.jsx)("label",{className:"form-check-label",htmlFor:e._id,children:e.name.substr(0,1).toUpperCase()+e.name.substr(1)})]},e._id)})):null,Object(n.jsx)("button",{type:"submit",onClick:D,className:"btn btn-primary col mx-3",children:"Add"})]})]})}var M=c(18),_=c(37),U=function(e){var t=e.component,c=Object(_.a)(e,["component"]),a=Object(s.useContext)(j).setUser;return Object(s.useEffect)((function(){localStorage.getItem("bottletoken")?a(Object(B.a)(localStorage.getItem("bottletoken"))):a(null)}),[a]),localStorage.getItem("bottletoken")?Object(n.jsx)(d.b,Object(M.a)(Object(M.a)({},c),{},{render:function(e){return Object(n.jsx)(t,Object(M.a)(Object(M.a)({},c),e))}})):Object(n.jsx)(d.a,{to:"/login"})},F=function(){var e=Object(s.useContext)(j),t=e.message,c=e.setMessage,a=e.user,r=e.setUser,o=e.setToken;Object(s.useEffect)((function(){setTimeout((function(){c("")}),5e3)}),[t,c]),Object(s.useEffect)((function(){localStorage.getItem("bottletoken")?(r(Object(B.a)(localStorage.getItem("bottletoken"))),o(localStorage.getItem("bottletoken"))):r(null)}),[r,o]);return Object(n.jsxs)("div",{children:[a?Object(n.jsx)(u.b,{to:"/",children:Object(n.jsx)("button",{className:"btn btn-primary float-right",onClick:function(){r(null),localStorage.removeItem("bottletoken")},children:"D\xe9connecter"})}):Object(n.jsx)(u.b,{to:"/login",children:Object(n.jsx)("button",{className:"btn btn-primary float-right",children:"Login"})}),Object(n.jsx)(u.b,{to:"/",children:Object(n.jsx)("button",{className:"btn btn-primary",children:"Home"})}),a&&!0===a.is_admin?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(u.b,{to:"/addbottle",children:Object(n.jsx)("button",{className:"btn btn-primary",children:"Add a Bottle"})}),Object(n.jsx)(u.b,{to:"/ingredients",children:Object(n.jsx)("button",{className:"btn btn-primary",children:"Ingredients"})})]}):null]})};var E=function(){return Object(n.jsx)(b,{children:Object(n.jsx)("div",{className:"container",children:Object(n.jsxs)(u.a,{children:[Object(n.jsx)(F,{}),Object(n.jsxs)(d.d,{children:[Object(n.jsx)(d.b,{exact:!0,path:"/",component:y}),Object(n.jsx)(U,{exact:!0,path:"/addbottle",component:P}),Object(n.jsx)(d.b,{exact:!0,path:"/login",component:I}),Object(n.jsx)(d.b,{exact:!0,path:"/register",component:L}),Object(n.jsx)(d.b,{component:y})]})]})})})},A=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,70)).then((function(t){var c=t.getCLS,n=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;c(e),n(e),s(e),a(e),r(e)}))};o.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(E,{})}),document.getElementById("root")),A()}},[[69,1,2]]]);
//# sourceMappingURL=main.119ab13f.chunk.js.map